Protocolo para transferencia de vários arquivos:

1. O TX envia ao RX uma string (ASCII) de início: "iniciando transferencia\n".

2. O RX responde com uma string (ASCII) sinalizando que está apto a receber: "apto a receber\n". Caso não receba a esta string, o RX envia ao TX a string (ASCII) "inapto a realizar transferencia\n" e o processo é encerrado com o RX mostrando a mesma mensagem.

3. Caso TX receba a string "apto a receber\n" de RX, o processo segue normalmente, caso contrário, o processo é encerrado e TX mostra a mensagem: "inapto a realizar transferencia".

4. O TX envia ao RX uma string (ASCII) contendo a quantidade de arquivos a serem enviados acompanhada de um '\n' no final e espera a confimação de recebimento de RX com a string (ASCII) "quantidade de arquivos recebida\n".

5. O RX decodifica a quantidade de arquivos a serem recebidos e inicia o processo de recebimento e cópias dos arquivos. Caso haja erro no processo de recebimento da quantidade de arquivos, o RX irá enviar a string (ASCII) "falha no recebimento da quantidade de arquivos: [erro]" para o TX.

6. O TX inicia o processo de envio, onde para cada arquivo a ser enviado ele fará as seguintes operações: envia o nome do arquivo em formato de string (ASCII) acompanhado de um '\n' ao final, após isso, lê linha a linha do arquivo e as envia ao RX em formato de uma string (ASCII). Ao terminar o envio das linhas o TX envia ao RX uma string (ASCII) "TX__EOF__RX\n" indicando fim de arquivo.

7. Ao receber o nome do arquivo, o RX o decodifica e envia ao TX uma string (ASCII) de confirmação "nome do arquivo recebido\n". Ao receber as linhas do arquivo o RX envia uma string (ASCII) de confirmação "linha recebida\n" identificando as linhas do arquivo por meio do caractere de fim de linha '\n'. Caso o TX não receba as mensagens de confirmação de recebimento de nome de arquivo ele mostra a mensagem "falha ao enviar nome de arquivo", caso a falha seja para a linha de arquivo ele mostra a mensagem "falha ao enviar linha de arquivo" e encerra o processo.

8. O RX escreve cada linha recebida em um novo arquivo de mesmo nome no diretorio ~/Documentos até identificar a string "TX__EOF__RX\n" que indicará que o arquivo acabou.

9. O RX repete os passos 7 e 8 até que a quantidade de arquivos a ser recebida chegue ao fim.

10. O RX envia uma string (ASCII) contendo as mensagens de confirmação de recebimento e cópia do arquivo para o TX: "arquivo 'nome_arquivo.ext' recebido e copiado com sucesso\n", em caso de sucesso. Em caso de falha a mensagem de erro será: 'erro ao transferir arquivo "nome_arquivo.ext". [tipo de erro]\n'.

11. Ao receber a lista de resultados de RX, o TX decodifica, identifica a lista a partir do caractere '\n' e exibe seu conteúdo.

12. O TX envia uma confirmação de recebimento de resultados no formato de uma string (ASCII): "resultados recebidos com sucesso!\n".

13. Caso o RX receba a mensagem de confirmação de recebimento do TX, ele envia ao TX uma mensagem em formato de string (ASCII) indicando fim de execução das transferências: "transferencias finalizadas\n". Caso contrário, o RX exibe uma mensagem com a string (ASCII): "nao foi possivel receber confirmacao de transferencia\n"


TX: Gabriel
RX: Alexa
